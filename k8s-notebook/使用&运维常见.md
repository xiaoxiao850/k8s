# 使用&运维常见

1. 拉取镜像 timeout

   ![image-20231205113834744](C:\Users\15313\AppData\Roaming\Typora\typora-user-images\image-20231205113834744.png)

   Failed to pull image "registry.k8s.io/sig-storage/csi-node-driver-registrar:v2.5.1"

   解决方法：

   - 查看部署yaml拉取镜像的策略是否是“always（总是从远端拉）”或者“IfNotPresent（查看本地没有再拉取）”。然后尝试本地拉取

   - 本地docker放置镜像加速。https://console.huaweicloud.com/swr/?agencyId=959e7c4ae9eb47b2bc5f6dfea736f099&region=cn-east-3&locale=zh-cn#/swr/mirror 。

     ![image-20231205114102735](C:\Users\15313\AppData\Roaming\Typora\typora-user-images\image-20231205114102735.png)

     ```
     {
         "registry-mirrors": [ "https://b6967b9dc64b42a19e77b25eff3b4bab.mirror.swr.myhuaweicloud.com" ]
     }
     ```

     

   - 在本地(该pod被调度到的节点上)拉取：

     ```bash
     $ sudo docker search csi-node-driver-registrar
     #选取
     $ sudo docker pull dyrnq/csi-node-driver-registrar:v2.5.1
     #重命名 为目标镜像名，并删除原来的
     $ sudo docker tag dyrnq/csi-node-driver-registrar:v2.5.1  registry.k8s.io/sig-storage/csi-node-driver-registrar:v2.5.1
     $ sudo docker rmi dyrnq/csi-node-driver-registrar:v2.5.1
     
     ```

     

   - 

     在主机间传递镜像

     

     ```bash
     $ sudo docker save -o csi_images.tar registry.k8s.io/sig-storage/csi-provisioner:v3.2.0 registry.k8s.io/sig-storage/csi-node-driver-registrar:v2.5.1
     
     $ scp csi_images.tar aiedge@xx-test-node236:/path/to/destination/
     
     $ sudo docker load -i /path/to/destination/csi_images.tar
     
     ```
   
     
   
   - ctr -n k8s.io i ls这是查看这个命名空间下的镜像的命令
   
     sudo ctr -n k8s.io images import csi_images.tar **加载 Docker 镜像到 containerd**